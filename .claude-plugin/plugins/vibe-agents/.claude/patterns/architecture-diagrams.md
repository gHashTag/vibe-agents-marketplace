# 🏗️ Диаграммы Архитектуры

**Визуализация системы роевого интеллекта VIBEE**

---

## 🌟 Общая Архитектура системы

```
┌────────────────────────────────────────────────────────────────────────────┐
│                        VIBEE Ecosystem                                   │
│                  (Экосистема Роевого Интеллекта)                         │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────────────┐
                    │       VIBE-LEAD (Queen Bee)           │
                    │     (Центральный координатор)         │
                    │                                        │
                    │  - Координация всех агентов            │
                    │  - Распределение задач                │
                    │  - Контроль качества                   │
                    └──────────────┬────────────────────────┘
                                    │
                    ┌───────────────┼────────────────────────┐
                    │               │                        │
                    ▼               ▼                        ▼
        ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
        │  Планирование    │  │  Разработка      │  │  Качество        │
        │                  │  │                  │  │                  │
        │ • VIBE-SPEC      │  │ • VIBE-CODER     │  │ • VIBE-TESTER    │
        │ • VIBE-TASKER    │  │ • VIBE-TYPESCRIPT│  │ • VIBE-CRITIC    │
        │ • VIBE-KNOWLEDGE │  │ • VIBE-AI-LLM    │  │ • VIBE-SENTRY    │
        └──────────────────┘  └──────────────────┘  └──────────────────┘
                    │               │                        │
                    ▼               ▼                        ▼
        ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
        │  Инфраструктура  │  │  Интеграции      │  │  Управление      │
        │                  │  │                  │  │                  │
        │ • VIBE-DEVOPS    │  │ • VIBE-MCP       │  │ • VIBE-ROI       │
        │ • VIBE-CICD      │  │ • VIBE-ELIZAOS   │  │ • VIBE-UPDATER   │
        │ • VIBE-SECURITY  │  │ • VIBE-LANGFUSE  │  │                  │
        └──────────────────┘  └──────────────────┘  └──────────────────┘
```

---

## 🐝 Queen Bee Pattern (Роевой Интеллект)

```
┌──────────────────────────────────────────────────────────────────────────┐
│                         QUEEN BEE PATTERN                               │
│                    (Паттерн Роевого Интеллекта)                         │
└──────────────────────────────────────────────────────────────────────────┘

                                    👑 VIBE-LEAD
                                    (Королева-Пчёлка)
                                         │
                          ┌─────────────┼─────────────┐
                          │             │             │
                    Рабочие       Рабочие       Рабочие
                     Пчёлки        Пчёлки        Пчёлки
                          │             │             │
                    ┌─────▼─────┐ ┌─────▼─────┐ ┌─────▼─────┐
                    │ VIBE-SPEC │ │ VIBE-CODER│ │VIBE-TESTER│
                    │ VIBE-TASK │ │ VIBE-TS   │ │ VIBE-CRIT │
                    └───────────┘ └───────────┘ └───────────┘
                          │             │             │
                          └─────────────┼─────────────┘
                                         │
                                    Отчёт о работе
                                    (статус, результаты)
```

### Цикл координации:

```
1. Задача поступает
         ↓
   👑 VIBE-LEAD
         ↓
2. Анализ задачи
         ↓
   Выбор агентов
         ↓
   Распределение
         ↓
3. Выполнение задач
         ↓
   Мониторинг прогресса
         ↓
4. Контроль качества
         ↓
   Исправления (если нужно)
         ↓
   Повтор (если не готово)
         ↓
5. Завершение
```

---

## ⚡ Автономный Цикл Агентов

```
┌──────────────────────────────────────────────────────────────────────────┐
│                     AUTONOMOUS AGENT CYCLE                              │
│                   (Автономный Цикл Агента)                              │
└──────────────────────────────────────────────────────────────────────────┘

                         ┌─────────────────┐
                         │  ПОЛУЧИТЬ       │
                         │    ЗАДАЧУ       │
                         └────────┬────────┘
                                  │
                         ┌────────▼────────┐
                         │  ВЫПОЛНИТЬ      │
                         │   ЗАДАЧУ        │
                         └────────┬────────┘
                                  │
                         ┌────────▼────────┐
                         │   ПРОВЕРИТЬ     │
                         │    РЕЗУЛЬТАТ    │
                         └──────┬──────────┘
                                │
                    ┌───────────┼───────────┐
                    │           │           │
              ✅ ГОТОВ       ❌ ОШИБКА   ❌ ТЕСТЫ
                    │           │           │
                    ▼           ▼           ▼
              ЗАВЕРШИТЬ   ИСПРАВИТЬ  ИСПРАВИТЬ
                    │           │           │
                    └───────────┼───────────┘
                                 │
                    ┌────────────▼────────────┐
                    │   СЛЕДУЮЩАЯ ЗАДАЧА?     │
                    └────────────┬────────────┘
                                 │
                          ДА ─────┘      НЕТ
                           ↓              ↓
                    ┌────────────┐   ┌────────────┐
                    │  НОВЫЙ     │   │ ПОЛНЫЙ     │
                    │  ИТЕРАЦИЯ  │   │ ОТЧЁТ      │
                    └────────────┘   └────────────┘
```

### Ключевые принципы:

- 🚫 **НЕ ВЫХОДИТЬ** пока все тесты не пройдут
- 🔄 **ПОВТОРЯТЬ** до успешного завершения
- 🛠️ **АВТОИСПРАВЛЯТЬ** ошибки самостоятельно
- ✅ **ПРОВЕРЯТЬ** качество на каждом шаге

---

## 🔄 Функциональное Программирование

```
┌──────────────────────────────────────────────────────────────────────────┐
│                   FUNCTIONAL PROGRAMMING FLOW                           │
│                 (Поток Функционального Программирования)                │
└──────────────────────────────────────────────────────────────────────────┘

          Входные данные
                ↓
        ┌───────────────┐
        │   pipe()      │  ← Композиция функций
        └───────┬───────┘
                │
        ┌───────▼───────┐      ┌───────────────┐
        │ validate()    │ ────▶│  eitherToTE   │  ← Конвертация
        └───────────────┘      └───────┬───────┘
                                        │
        ┌───────────────┐      ┌───────▼───────┐
        │ chain()       │ ◀────│  mapTask()    │  ← Трансформация
        └───────┬───────┘      └───────────────┘
                │
        ┌───────▼───────┐      ┌───────────────┐
        │  tapTask()    │ ────▶│   fold()      │  ← Обработка
        └───────┬───────┘      └───────┬───────┘
                │                       │
        ┌───────▼───────┐      ┌───────▼───────┐
        │  Результат    │ ◀────│   Ошибка      │  ← Выход
        └───────────────┘      └───────────────┘
```

### Слои абстракции:

```
┌────────────────────────────────────────┐
│           TaskEither                   │  ← Асинхронность + Ошибки
├────────────────────────────────────────┤
│              Either                    │  ← Синхронные операции
├────────────────────────────────────────┤
│            Function                    │  ← Базовые функции
└────────────────────────────────────────┘
```

---

## 🧪 TDD (Test-Driven Development)

```
┌──────────────────────────────────────────────────────────────────────────┐
│                           TDD CYCLE                                     │
│                     (Цикл Разработки через Тесты)                       │
└──────────────────────────────────────────────────────────────────────────┘

                    ┌─────────────┐
                    │  1. RED     │  ← Пишем тест (красный)
                    │ (Падает)    │
                    └──────┬──────┘
                           │
                    ┌───────▼──────┐
                    │   2. GREEN   │  ← Пишем код (зелёный)
                    │ (Проходит)   │
                    └──────┬──────┘
                           │
                    ┌───────▼──────┐
                    │  3. REFACTOR │  ← Улучшаем (рефакторинг)
                    │  (Чистый)    │
                    └──────┬──────┘
                           │
                    ┌───────▼──────┐
                    │  ПОВТОРИТЬ   │  ← Снова
                    │   ЦИКЛ       │
                    └──────────────┘
```

### Участники процесса:

```
        ┌──────────────┐
        │ VIBE-SPEC    │  ← Создаёт требования
        │              │
        └──────┬───────┘
               │
        ┌──────▼───────┐
        │ VIBE-TESTER  │  ← Пишет тесты
        │              │
        └──────┬───────┘
               │
        ┌──────▼───────┐
        │ VIBE-CODER   │  ← Пишет код
        │              │
        └──────┬───────┘
               │
        ┌──────▼───────┐
        │ VIBE-CRITIC  │  ← Рефакторинг
        │              │
        └──────────────┘
```

---

## 📚 Knowledge Keeper (Хранитель Знаний)

```
┌──────────────────────────────────────────────────────────────────────────┐
│                   VIBE-KNOWLEDGE-KEEPER                                │
│                      (Хранитель Знаний)                                │
└──────────────────────────────────────────────────────────────────────────┘

         Репозиторий
              │
        ┌─────▼─────┐
        │   Git     │  ← Исходный код
        └─────┬─────┘
              │
        ┌─────▼─────┐
        │ Анализатор│  ← Парсинг кода
        │  кода     │
        └─────┬─────┘
              │
        ┌─────▼─────┐
        │Генератор  │  ← Создание embeddings
        │векторов   │
        └─────┬─────┘
              │
    ┌─────────┼─────────┐
    │         │         │
┌───▼───┐ ┌───▼───┐ ┌───▼───┐
│Докум. │ │ Код   │ │Паттерн│
│Index  │ │ Index │ │ Index │
└───┬───┘ └───┬───┘ └───┬───┘
    │         │         │
    └─────────┼─────────┘
              │
        ┌─────▼─────┐
        │  Векторная│  ← Поиск и рекомендации
        │    БД     │
        └─────┬─────┘
              │
        ┌─────▼─────┐
        │  Агенты   │  ← Использование знаний
        └───────────┘
```

---

## 🔍 Diagnostics (Диагностика)

```
┌──────────────────────────────────────────────────────────────────────────┐
│                      VIBE-DIAGNOSTICS                                  │
│                        (Диагностика)                                   │
└──────────────────────────────────────────────────────────────────────────┘

    ┌─────────────┐
    │   Агенты    │  ← Источник метрик
    └─────┬───────┘
          │
    ┌─────▼───────┐
    │   Сбор      │  ← Телеметрия
    │  метрик     │
    └─────┬───────┘
          │
    ┌─────▼───────┐
    │  Анализ     │  ← Обработка
    │  данных     │
    └─────┬───────┘
          │
    ┌─────▼───────┐
    │ Веб-интерфейс│  ← Визуализация
    └─────┬───────┘
          │
    ┌─────▼─────┐ ┌─▼────────┐
    │ Метрики   │ │  Алерты  │
    │           │ │          │
    └───────────┘ └──────────┘
          │           │
    ┌─────▼─────┐ ┌─▼────────┐
    │ Мониторинг│ │Уведомления│
    └───────────┘ └──────────┘
```

---

## 🔐 Безопасность и Валидация

```
┌──────────────────────────────────────────────────────────────────────────┐
│                     SECURITY & VALIDATION                               │
│                   (Безопасность и Валидация)                           │
└──────────────────────────────────────────────────────────────────────────┘

      Входные данные
            │
      ┌─────▼─────┐
      │   Zod     │  ← Валидация схем
      │  Schema   │
      └─────┬─────┘
            │
      ┌─────▼─────┐
      │TypeScript │  ← Статическая типизация
      │  Types    │
      └─────┬─────┘
            │
      ┌─────▼─────┐
      │ TaskEither│  ← Обработка ошибок
      └─────┬─────┘
            │
      ┌─────▼─────┐
      │ VIBE-     │  ← Логирование
      │ SENTRY    │
      └─────┬─────┘
            │
      ┌─────▼─────┐
      │ Безопасный│  ← Результат
      │ результат │
      └───────────┘
```

---

## 🔌 MCP (Model Context Protocol)

```
┌──────────────────────────────────────────────────────────────────────────┐
│                         MCP INTEGRATION                                 │
│                    (Интеграция MCP)                                    │
└──────────────────────────────────────────────────────────────────────────┘

         Claude Code
              │
              ▼
    ┌─────────────────┐
    │   MCP Client    │  ← Клиент протокола
    └────────┬────────┘
             │
    ┌────────▼────────┐
    │  MCP Servers    │  ← Серверы
    │                 │
    │ ┌─────────────┐ │
    │ │     fal     │ │  ← Генерация изображений
    │ └─────────────┘ │
    │ ┌─────────────┐ │
    │ │    neon     │ │  ← База данных
    │ └─────────────┘ │
    │ ┌─────────────┐ │
    │ │   sentry    │ │  ← Мониторинг
    │ └─────────────┘ │
    └────────┬────────┘
             │
             ▼
        Результаты
```

---

## 📊 Поток Данных

```
┌──────────────────────────────────────────────────────────────────────────┐
│                      DATA FLOW                                          │
│                     (Поток Данных)                                     │
└──────────────────────────────────────────────────────────────────────────┘

   Input → Task → Agents → Output
     ↓       ↓       ↓        ↓
   Валид. План  Исполнение Результат
     ↓       ↓       ↓        ↓
   Schema  TDD   Monitoring Отчёт
     ↓       ↓       ↓        ↓
   Zod   "7 раз"  Sentry   ROI анализ
         отмерь
```

---

## 🎯 Жизненный Цикл Задачи

```
┌──────────────────────────────────────────────────────────────────────────┐
│                     TASK LIFECYCLE                                      │
│                  (Жизненный Цикл Задачи)                                │
└──────────────────────────────────────────────────────────────────────────┘

1. ПОСТУПЛЕНИЕ ЗАДАЧИ
         ↓
   VIBE-SPEC анализирует
         ↓
2. ПЛАНИРОВАНИЕ
         ↓
   VIBE-TASKER создаёт план
         ↓
3. РАСПРЕДЕЛЕНИЕ
         ↓
   VIBE-LEAD выбирает агентов
         ↓
4. ВЫПОЛНЕНИЕ
         ↓
   Агенты работают автономно
         ↓
5. КОНТРОЛЬ
         ↓
   VIBE-TESTER проверяет тесты
         ↓
6. КАЧЕСТВО
         ↓
   VIBE-CRITIC ревьюит
         ↓
7. ЗАВЕРШЕНИЕ
         ↓
   VIBE-ROI анализирует результат
         ↓
   ОТЧЁТ ГОТОВ
```

---

*Архитектура построена на принципах функционального программирования, автономности и роевого интеллекта! 🐝✨*
